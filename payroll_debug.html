<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payroll Debug</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; border-radius: 5px; }
        .allowance, .deduction { margin: 5px 0; padding: 10px; background: #f5f5f5; border-radius: 3px; }
        .percentage { background: #007bff; color: white; padding: 2px 6px; border-radius: 3px; font-size: 0.8em; }
        .amount { float: right; font-weight: bold; }
        button { padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
        button:hover { background: #0056b3; }
        pre { background: #f8f9fa; padding: 10px; border-radius: 5px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>Payroll Data Debug</h1>
    
    <button onclick="fetchPayrollData()">Fetch Payroll Data</button>
    
    <div class="section">
        <h2>Raw API Response</h2>
        <pre id="rawData">Click "Fetch Payroll Data" to see raw response</pre>
    </div>

    <div class="section">
        <h2>Parsed Payroll Information</h2>
        <div id="payrollInfo">No data loaded</div>
    </div>

    <script>
        async function fetchPayrollData() {
            try {
                const response = await fetch('http://localhost:5050/api/employees/685fd6ac8efc4645efe472a7/payroll');
                const data = await response.json();
                
                // Display raw data
                document.getElementById('rawData').textContent = JSON.stringify(data, null, 2);
                
                // Display parsed data
                let html = `
                    <div><strong>Employee:</strong> ${data.name}</div>
                    <div><strong>Basic Salary (Monthly):</strong> ₹${data.basicSalary?.toLocaleString('en-IN')}</div>
                    <div><strong>Gross Salary (Monthly):</strong> ₹${data.grossSalary?.toLocaleString('en-IN')}</div>
                    <div><strong>Net Salary (Monthly):</strong> ₹${data.netSalary?.toLocaleString('en-IN')}</div>
                    
                    <h3>Allowances</h3>
                `;
                
                if (data.allowances && data.allowances.length > 0) {
                    data.allowances.forEach(allowance => {
                        html += `
                            <div class="allowance">
                                <span>${allowance.name}</span>
                                <span class="percentage">${allowance.percentage || 0}%</span>
                                <span class="amount">₹${allowance.amount?.toLocaleString('en-IN')}</span>
                            </div>
                        `;
                    });
                } else {
                    html += '<div>No allowances found</div>';
                }
                
                html += '<h3>Deductions</h3>';
                
                if (data.deductions && data.deductions.length > 0) {
                    data.deductions.forEach(deduction => {
                        html += `
                            <div class="deduction">
                                <span>${deduction.name}</span>
                                <span class="percentage">${deduction.percentage || 0}%</span>
                                <span class="amount">₹${deduction.amount?.toLocaleString('en-IN')}</span>
                            </div>
                        `;
                    });
                } else {
                    html += '<div>No deductions found</div>';
                }
                
                document.getElementById('payrollInfo').innerHTML = html;
                
            } catch (error) {
                console.error('Error fetching payroll data:', error);
                document.getElementById('rawData').textContent = 'Error: ' + error.message;
                document.getElementById('payrollInfo').innerHTML = 'Error fetching data: ' + error.message;
            }
        }
    </script>
</body>
</html>
